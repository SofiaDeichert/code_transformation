int main ( ) { int t , n , i , j , large , larger , largec , sum ; scanf ( "%d" , & t ) ; while ( t -- ) { sum = 0 ; large = 0 ; scanf ( "%d" , & n ) ; int * tri [ n ] ; for ( i = 0 ; i < n ; i ++ ) { tri [ i ] = ( int * ) malloc ( sizeof ( int ) * ( i + 1 ) ) ; for ( j = 0 ; j < i + 1 ; j ++ ) { scanf ( "%d" , & tri [ i ] [ j ] ) ; if ( large < tri [ i ] [ j ] ) { large = tri [ i ] [ j ] ; larger = i ; largec = j ; } } } for ( i = larger , j = largec ; i >= 0 ; i -- ) { if ( j == 0 ) { sum += tri [ i ] [ j ] ; } else if ( j == i ) { sum += tri [ i ] [ j -- ] ; } else { sum += tri [ i ] [ j ] ; if ( tri [ i - 1 ] [ j ] < tri [ i - 1 ] [ j - 1 ] ) j -- ; } } for ( i = larger + 1 , j = ( tri [ larger + 1 ] [ largec ] < tri [ larger + 1 ] [ largec + 1 ] ? largec + 1 : largec ) ; i < n ; i ++ ) { sum += tri [ i ] [ j ] ; if ( tri [ i + 1 ] [ j ] < tri [ i + 1 ] [ j + 1 ] ) j ++ ; } printf ( "%d\n" , sum ) ; } return 0 ; }