int main ( ) { int l , t , k , a = 0 , m , n , o , p = 0 ; register int i , j , sum = 0 , summax = 0 , q ; int arr [ 101 ] [ 101 ] , arr2 [ 101 ] , * p2 ; p2 = arr2 ; scanf ( "%d" , & k ) ; for ( q = 0 ; q < k ; q ++ ) { sum = 0 ; scanf ( "%d" , & t ) ; for ( i = 0 ; i < t ; i ++ ) { for ( j = 0 ; j <= i ; j ++ ) { scanf ( "%d" , & arr [ i ] [ j ] ) ; } } for ( i = 0 , j = 0 ; i < t ; i ++ ) { p2 [ i ] = 0 ; sum = sum + arr [ i ] [ j ] ; summax = sum ; } for ( l = 0 ; p2 [ t - 1 ] != ( t - 1 ) ; l ++ ) { a = 0 ; sum = 0 ; m = p2 [ t - 1 ] ; o = m ; p = 0 ; n = t - m - 1 ; if ( m > 2 ) { for ( i = t - 1 ; ( p2 [ i ] - p2 [ i - 1 ] ) == 1 ; i -- ) { p ++ ; } if ( ( p > 1 ) && ( p2 [ t - p - 1 ] == p2 [ t - p - 2 ] ) && ( p2 [ t - p - 1 ] != 0 ) ) { for ( i = t - 1 ; i >= ( t - p - 1 ) ; i -- ) { p2 [ i ] = p2 [ t - p ] ; j = p2 [ i ] ; sum = sum + arr [ i ] [ j ] ; } for ( i = t - p - 2 ; i >= 0 ; i -- ) { j = p2 [ i ] ; sum = sum + arr [ i ] [ j ] ; } goto step1 ; } } if ( ( m > 1 ) && ( p2 [ n ] == 0 ) ) { for ( i = t - 1 ; o >= 0 ; o -- , i -- ) { p2 [ i ] = p2 [ n ] + 1 ; } for ( i = t - 1 ; i >= 0 ; i -- ) { j = p2 [ i ] ; sum = sum + arr [ i ] [ j ] ; } } else { for ( i = t - 1 ; i >= 0 ; i -- ) { j = p2 [ i ] ; if ( ( p2 [ i ] < ( t - 1 ) ) && ( p2 [ i ] == p2 [ i - 1 ] ) && ( a == 0 ) ) { j ++ ; a ++ ; p2 [ i ] = j ; sum = sum + arr [ i ] [ j ] ; } else { j = p2 [ i ] ; sum = sum + arr [ i ] [ j ] ; } } } if ( sum > summax ) { summax = sum ; } step1 : ; } printf ( "%d" , summax ) ; } return 0 ; }