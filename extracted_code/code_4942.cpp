int max ( int a , int b ) { if ( a > b ) return a ; return b ; } int sum ( int * * A , int i , int j , int * * MEMO , int n ) { if ( i == n - 1 ) { MEMO [ i ] [ j ] = A [ i ] [ j ] ; return MEMO [ i ] [ j ] ; } if ( MEMO [ i + 1 ] [ j ] == - 1 && MEMO [ i + 1 ] [ j + 1 ] == - 1 ) MEMO [ i ] [ j ] = A [ i ] [ j ] + max ( sum ( A , i + 1 , j , MEMO , n ) , sum ( A , i + 1 , j + 1 , MEMO , n ) ) ; else if ( MEMO [ i + 1 ] [ j ] != - 1 && MEMO [ i + 1 ] [ j + 1 ] != - 1 ) MEMO [ i ] [ j ] = A [ i ] [ j ] + max ( MEMO [ i + 1 ] [ j ] , MEMO [ i + 1 ] [ j + 1 ] ) ; else if ( MEMO [ i + 1 ] [ j ] == - 1 ) MEMO [ i ] [ j ] = A [ i ] [ j ] + max ( sum ( A , i + 1 , j , MEMO , n ) , MEMO [ i + 1 ] [ j + 1 ] ) ; else if ( MEMO [ i + 1 ] [ j + 1 ] == - 1 ) MEMO [ i ] [ j ] = A [ i ] [ j ] + max ( sum ( A , i + 1 , j + 1 , MEMO , n ) , MEMO [ i + 1 ] [ j ] ) ; return MEMO [ i ] [ j ] ; } int main ( ) { int T ; scanf ( "%d" , & T ) ; while ( T -- ) { int n ; scanf ( "%d" , & n ) ; int size = n ; int * * A = ( int * * ) malloc ( n * sizeof ( int * ) ) ; int * * MEMO = ( int * * ) malloc ( n * sizeof ( int * ) ) ; int i = 0 , j = 0 ; int level = 0 ; for ( i = 0 ; i < size ; i ++ ) { A [ i ] = ( int * ) malloc ( n * sizeof ( int ) ) ; MEMO [ i ] = ( int * ) malloc ( n * sizeof ( int ) ) ; memset ( A [ i ] , 0 , n * sizeof ( int ) ) ; memset ( MEMO [ i ] , - 1 , n * sizeof ( int ) ) ; } for ( i = 0 ; i < n ; i ++ ) { level ++ ; for ( j = 0 ; j < level && j < n ; j ++ ) { scanf ( "%d" , & A [ i ] [ j ] ) ; } } printf ( "%d\n" , sum ( A , 0 , 0 , MEMO , size ) ) ; } }