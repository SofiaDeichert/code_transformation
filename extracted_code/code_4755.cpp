int main ( ) { int n , m , sum = 0 , i , j , * b , k = 0 , temp1 = 0 , temp2 = 0 , l = 0 ; scanf ( "%d" , & n ) ; int ar [ 100 ] [ 100 ] ; for ( ; n > 0 ; n -- ) { scanf ( "%d" , & m ) ; b = calloc ( m , sizeof ( int ) ) ; for ( i = 0 ; i < m ; i ++ ) { for ( j = 0 ; j <= i ; j ++ ) scanf ( "%d" , & ar [ i ] [ j ] ) ; } for ( i = 0 ; i < m ; i ++ ) { sum += ar [ i ] [ 0 ] ; l += ar [ i ] [ i ] ; } temp1 = temp2 = sum ; for ( j = m - 1 ; j > k ; ) { if ( b [ j ] == b [ j - 1 ] ) { temp1 = temp1 - ar [ j ] [ b [ j ] ] + ar [ j ] [ 1 + b [ j ] ] ; b [ j ] ++ ; if ( sum < temp1 ) sum = temp1 ; j = m - 1 ; } if ( b [ j ] == j ) { k ++ ; j = m - 1 ; } if ( ( b [ j ] - 1 ) == b [ j - 1 ] ) j -- ; } b = calloc ( m , sizeof ( int ) ) ; k = 0 ; for ( j = m - 1 ; j > k ; j -- ) { if ( b [ j ] == b [ j - 1 ] || ( b [ j ] - 1 ) == b [ j - 1 ] ) { temp2 = temp2 - ar [ j ] [ b [ j ] ] + ar [ j ] [ 1 + b [ j ] ] ; b [ j ] ++ ; if ( sum < temp2 ) sum = temp2 ; } if ( b [ j ] == j ) { k ++ ; j = m - 1 ; } } if ( sum < l ) sum = l ; printf ( "%d\n" , sum ) ; sum = temp1 = temp2 = k = l = 0 ; } return 0 ; }